<h1>
Руководство
</h1>
<div style="width: 39%;display: inline-block;">
	<h3 style="margin:0px">
	Содержание
	</h3>
	<ul id="contents">
	</ul>
</div>
<div style="width: 60%;display: inline-block;">
	<p>
	OBR Tracker состоит из нескольких модулей, каждый из которых имеет независимый функционал. Модули включаются и отключаются через всплывающее меню. Ниже описывается установка и настройка расширения с помощью всплывающего меню, а затем описывается использование каждого модуля.
	</p>
</div>


<h2 id="install">
Установка
</h2>
<p>
Исходный код доступен в <a target="blank" href="https://github.com/redweller/obr_tracker">репозитории GitHub</a>, вы также можете использовать его для ручной установки OBR Tracker для вашего браузера в режиме разработчика. Кроме того, как и любое другое расширение для браузера, OBRT легко устанавливается из интернет-магазинов для всех основных браузеров одним щелчком мыши. 
</p>
<h3>
Десктопные браузеры
</h3>
<p>
Быстрые ссылки для установки в один клик из разных интернет-магазинов:</p>
<ul>
	<li><a target="blank" href="https://chrome.google.com/webstore/detail/owlbear-rodeo-combat-trac/lcfcmebjoechmikocfjjeocnljconfdp">Chrome Web Store</a></li>
	<li><a target="blank" href="https://microsoftedge.microsoft.com/addons/detail/owlbear-rodeo-tracker/eejflcokmghbnkekboiflnpjjidcdjif">MS Edge Addons</a></li>
	<li><a target="blank" href="https://addons.mozilla.org/firefox/addon/owlbear-combat-tracker/">Firefox AMO</a></li>
	<li><a target="blank" href="https://addons.opera.com/extensions/details/owlbear-rodeo-tracker/">Opera Addons</a></li>
</ul>
<p>
Большинство других браузеров поддерживают установку из Интернет-магазина Chrome. Пользователям Opera не рекомендуется загружать дополнение из Opera Store, учитывая большую задержку перед публикацией. Вы рискуете получить устаревшую версию - вместо этого лучше пользоваться версией Chrome Store. 
</p>
<h3>
Мобильные браузеры
</h3>
<p>
Из-за ограничительной политики большинства разработчиков в отношении мобильных расширений, OBRT недоступен в распространённых мобильных браузерах. Это значит, что он не работает на устройствах с iOS. Однако на Android есть менее популярные браузеры, поддерживающие расширения Chrome, и OBRT отлично работает в них. Например, попробуйте <a target="blank" href="https://kiwibrowser.com/">Kiwi Browser</a>.
</p><p>
Если вы предпочитаете более известные браузеры, другой вариант — использовать  <a target="blank" href="https://play.google.com/store/apps/details?id=org.mozilla.fenix">Firefox Nightly</a>. Запуск OBRT в нём потребует некоторых дополнительных шагов:
</p>
<ul>
	<li>Откройте Меню -> Настройки -> О Firefox Nightly</li>
	<li>Нажмите пять раз на логотип Firefox, чтобы открыть меню отладки.</li>
	<li>Вернитесь в Настройки и откройте Собственную коллекцию дополнений.</li> 
	<li>Введите ID: <strong>17070171</strong>, Имя коллекции: <strong>obr</strong></li>
</ul>
<p>
После этого вы можете просто открыть меню дополнений и включить OBRT как обычное расширение. Обратите внимание, что обновления дополнений отключены в этом режиме. Более подробная информация об использовании расширений в Firefox Nightly приведена в <a target="blank" href="https://blog.mozilla.org/addons/2020/09/29/expanded-extension-support-in-firefox-for-android-nightly/">этой статье от Mozilla</a>.
</p><p>
Какой бы браузер вы ни выбрали, единственным отличием от настольной версии является то, что кнопка расширения отображается глубоко внутри меню браузера, а всплывающее окно настроек открывается в полноэкранном режиме. 
</p>


<h2 id="menu">
Всплывающее меню
</h2>
<p>
Кнопка расширения - небольшая иконка <img src="../images/combat16.png">, которая появляется на панели вашего браузера после установки этого расширения. В зависимости от браузера для её отображения могут потребоваться дополнительные действия. Эта кнопка открывает меню расширения, которое предоставляет доступ к настройкам. 
</p>
<img src="../images/help_menu.jpg" alt="Пустая страница с открытым меню OBRT" title="Пустая страница с открытым меню OBRT">
<h3>
Модули
</h3>
<p>
Каждый модуль включить или отключить, установив соответствующий флажок в подменю "Модули". Варианты перечислены ниже:
</p>
<ul>
	<li>Трекер боёв - полностью включает/отключает список персонажей, боевые раунды и остальные соответствующие функции.</li>
	<li>Трекер кубиков - полностью включает/отключает журнал бросков кубиков, а также некоторые дополнительные настройки лотка кубов OBR.</li>
	<li>Звуки кубиков - полностью включает/отключает звук, воспроизводимый при броске, как вами, так и когда кто-то другой бросает кубик.</li>
</ul>
<p>
<span class="note">Чтобы применить изменения модулей, вы должны перезагрузить страницу OBR.</span>
</p>
<h3>
Настройки
</h3>
<p>
В этом разделе меню настраиваются небольшие модификации поведения OBR. Каждую функцию можно включить или отключить, установив соответствующий флажок в подменю "Настройки". Варианты перечислены ниже:
</p>
<ul>
	<li>Сбрасывать панель - автоматически сбрасывает выбранный инструмент к дефолтному Перемещению (Move Tool), когда панель инструментов (Map Tools) свёрнута.</li>
	<li>Свернуть панели - просто экономит время, автоматически скрывая родные панели при загрузке OBR (удобно держать эту опцию включённой, если вы не GM и/или играете на смартфоне).</li> 
</ul>
<p>
<span class="note">Чтобы применить эти настройки, вы должны перезагрузить страницу OBR.</span>
</p>
<h3>
Последние игры
</h3>
<p>
Меню расширения также отслеживает последние игры и позволяет быстро открыть ссылку на любую недавнюю игру, в которую вы играли в текущем браузере. Если где-то на вкладках вашего браузера открыта игра Owlbear Rodeo, вы можете просто переключиться на эту вкладку из списка.
</p>
<h3>
Кнопка подтверждения
</h3>
<p>
Кнопка действия в нижней части меню расширения меняется в зависимости от контекста. Она позволяет быстро открыть OBR или перейти на вкладку с ним, если она уже открыта. Если вы меняете какие-то настройки - она позволяет сохранить изменения, а затем позволяет перезагрузить страницу OBR. 
</p>
<h3>
Версионность
</h3>
<p>
Первые две строки меню представляют версию самого расширения OBRT и последнюю версию OBR, с которой оно было протестировано.
</p><p>
Полезно отслеживать версию OBRT, потому что разные магазины аддонов могут обновляться неодновременно, и вы можете получить версию аддона, отличную от ваших друзей (очевидно, этой ситуации лучше избегать). Попробуйте обновить расширение вручную.
</p><p>
Номер версии Owlbear Rodeo полезен для устранения общих неполадок. Если у вас возникли какие-либо проблемы, это может означать, что OBR был обновлен и OBRT перестал работать - в этом случае версия OBR, указанная на главной странице сервиса, будет больше, чем версия "Проверено с OBR" в меню OBRT. Вам просто нужно подождать, пока расширение будет обновлено. 
</p>


<h2 id="combat">
Трекер боёв
</h2>
<p>
Небольшое окошко в правом верхнем углу со списком всех персонажей, отслеживанием ходов, раундов, а также здоровья, урона и состояния. Трекер берет именованные токены с карты и позволяет присваивать им значения инициативы, а также остальные данные. 
</p>
<img src="../images/help_combat.jpg" alt="Трекер боя для GM-а и для игрока" title="Трекер боя для GM-а и для игрока">
<h3>
Важные замечания
</h3>
<ul>
	<li>Боевой трекер работает только с <strong>именованными токенами</strong>. Он не покажет токены без имени или токены, не обозначающие персонажей (Character).</li>
	<li>Трекер ведёт один человек (обычно это владелец карты и GM), который вводит все данные вручную. Другие только просматривают то, что он ввёл.</li>
	<li>Другим игрокам <strong>необходимо установить такое же дополнение</strong>, чтобы видеть информацию о бое. Само собой, модуль трекера тоже должен быть включен.</li>
</ul><p>
<span class="note">Данные боя передаются с помощью встроенных в OBR стикеров (Note), поэтому имеются ограничения. Подробнее об этом в разделе <a href="#sharing">Обмен данными боя</a>.</span>
</p>
<h3>
Список персонажей
</h3>
<p>
Когда вы впервые откроете новую карту и начнёте добавлять токены, их названия появятся на оверлее трекера. Цветная точка рядом с каждой записью представляет собой цвет контура круга соответствующего маркера (белый, если не указан).
</p><p>
Когда вы добавляете или удаляете токены, трекер всегда будет отображать текущий набор персонажей на карте. Если вы хотите исключить какого-либо персонажа из трекера боя, удалите имя токена или измените тип жетона на любой другой, кроме персонажа (например, Mount). 
</p>
<h3>
Присванивание характеристик
</h3>
<p>
Одним из способов редактирования боевых данных является массовое назначение статистики. Маленькая кнопка <img src="../images/settings.png"> в левом нижнем углу Трекера боя открывает меню, в котором вы можете назначить базовые характеристики (инициатива и, опционально, HP) всем персонажам. Если у некоторых персонажей окажется одинаковая инициатива, их значения будут выделены красным цветом. Массовое редактирование доступно только вне боя, и этого достаточно, чтобы быстро начать бой.
</p><p>
Другой способ - отредактировать характеристики индивидуально для любого персонажа. Нажмите на любую запись, чтобы открыть статистику для этого персонажа. Здесь вы можете указать более подробную информацию - помимо INIT и HP, вы также можете установить урон и условия/эффекты. 
</p>
<h3>
Ведение боя
</h3>
<p>
После того, как вы указали инициативу нескольким персонажам, вы заметите, что они будут упорядочены в списке в соответствии с этими значениями. Персонажи без указанной INIT выделены серым цветом - они не будут участвовать в бою. Вы можете начать бой, нажав "Старт" в нижней части оверлея, если у вас есть хотя бы один персонаж с Инициативой.
</p><p>
Затем вы можете переключать ходы, нажимая "Далее", и трекер подсветит текущего персонажа и подсчитает для вас боевые раунды. В любое время вы можете нажать на персонажа, чтобы ввести новые состояния или повреждения. Состояния автоматически сбрасываются после установленного количества раундов - их соответствующие значки исчезают, когда значение "turns" падает до нуля.
</p><p>
Чтобы закончить бой, нажмите на мечи в левом нижнем углу. Появится подтверждающее сообщение. Если вы подтвердите, окончание боя сотрет все значения инициативы (поскольку обычно для следующего боя будут новые броски инициативы). Чтобы этого не произошло, задержите курсор мыши на подтверждении на 2 секунды - появится вторая кнопка, позволяющая завершить бой и сохранить значения INIT. 
</p>
<h3 id="sharing" style="padding-top: 30px;margin-top: -22px;">
Обмен данными боя
</h3>
<p>
Чтобы инициализировать совместное использование данных боевого трекера, GM должен создать видимый стикер (Note) с "!" (восклицательный знак) где-то за пределами карты. Если вы видите какие-то случайные символы в этом стикере после того, как ввели боевые характеристики, значит, вы всё делаете правильно. Эти символы представляют собой закодированные боевые данные, которые передаются другим игрокам через стикер. Сам стикер служит исключительно техническим целям, поэтому игрокам не нужно его видеть или взаимодействовать с ним - перетащите подальше от карты и забудьте о нём.
</p><p>
Стикер OBR может хранить ограниченное количество текста, поэтому количество токенов для обмена также ограничено (20 - 40, в зависимости от заполненности данных). Удаленные токены на той же карте также считаются. Так что если у вас орда NPC на одной карте, и ваши игроки вдруг жалуются, что боевой трекер завис - возможно, это из-за того, что лимит исчерпан. Счётчик в нижней части вкладки "Информация" покажет вам, насколько вы близки к достижению этого предела.
</p><p>
Даже если ваши игроки не используют OBRT, вы все равно можете использовать его для отслеживания раундов вместо ручки и бумаги. Тогда вам все равно полезно добавить "служебный" стикер, потому что при включенной передаче данных они также сохраняются между сеансами. 
</p>
<h3>
Проблемы с обменом данными
</h3>
<p>
Возможные причины и решения, если другие игроки не видят данные трекера боя: 
</p>
<ul>
	<li>Сначала проверьте, является ли стикер, созданный для обмена данными (с !) обычным, не заблокированным, видимым другим игрокам. Совместное использование данных не будет работать для заблокированных стикеров и, очевидно, не будет работать для скрытых стикеров (потому что тогда игроки не получат свои данные, и трекер боя не сможет их отобразить).</li>
	<li>Затем проверьте переключатель на вкладке "Info" в настройках трекера. У него есть два варианта - Мастер и Клиент. Обычно вам не нужно переключать их вручную, но на всякий случай: если вы GM - он должен быть переключён на Master, а для остальных игроков должно быть Client.</li>
	<li>Если передача данных боя работала, но в какой-то момент перестала обновляться, вероятно, это связано с тем, что вы достигли предела на количество данных. Проверьте Настройки -> вкладка Info, красная полоса емкости указывает на то, что лимит превышен.</li>
</ul><p>
<span class="note">Если ничего не помогает, попробуйте удалить стикер с ! и обновить страницу. Это должно сбросить кеш расширения, чтобы вы могли снова добавить данные.</span>
</p>
<h3>
Здоровье и урон
</h3>
<p>
Вы устанавливаете значения здоровья и урона, а затем трекер вычисляет состояние здоровья, вычитая одно из другого. Расчета дополнительного урона нет, так что вам придется каждый раз вводить интегральное значение.
</p><p>
В списке трекера состояние здоровья каждого персонажа визуально представлено 3 сердечками, указывающими общее состояние здоровья от здорового (все 3 зеленых) до легко раненого (1 красный), серьезного ранения (2 красных) и умирающего (осталось 0 зеленых сердечек). 
</p>
<h3>
Эффекты и состояния
</h3>
<p>
Вы можете установить до 3 различных состояний для каждого токена в меню статистики персонажа. Для каждого состояния/эффекта вы можете задать его имя и продолжительность в раундах. Продолжительность используется для отслеживания оставшихся ходов во время боя. Значки представляют 3 типа эффектов -
</p><ul>
	<li>бомба для физических состояний</li>
	<li>зелье для химическоих эффектов</li>
	<li>книга для магических эффектов</li>
</ul><p>
но это на самом деле не имеет большого значения. По сути, это просто место для записи и отслеживания до 3 эффектов, а значки предназначены для их визуального различения. 
</p>
<h3>
Скрытые токены и характеристики
</h3>
<p>
Есть много ситуаций, когда вы можете захотеть использовать способность OBR скрывать токены - вражеский плут, крадущийся рядом, или дюжина гоблинов, скрывающихся за стеной. Скрытые токены хорошо обрабатываются OBRT - Мастер видит скрытых персонажей в списке Трекера боя, а другие игроки не знают об их присутствии.
</p><p>
То же самое касается значений HP. И максимальное, и фактическое здоровье видны только Мастеру. Другие игроки не увидят точных значений HP, только общее состояние (представленное сердечками) и общее количество нанесенного урона.
</p>
<h3>
Изменение цвета тумана и фона
</h3>
<p>
Туман войны OBR, добавленный с помощью инструмента "Fog", по умолчанию имеет характерный серый цвет, отличный от цвета фона. Это не позволяет вам аккуратно скрыть края вашей карты за FOW. Кроме того, если у вашей карты есть широкая рамка вили собственный фон, иногда она смотрится не очень хорошо на родном фоне вокруг нее.
</p><p>
Вы можете изменить это, используя боевой трекер OBRT. Мод цветов включается в меню "Info" оверлея боевого трекера. Вы можете выбрать цвет фона (используйте стрелки для быстрого изменения значений HSL), и вы можете настроить туман так, чтобы он соответствовал его цвету. Изменения цвета тумана не видны в режиме редактирования тумана.
</p><p>
Если у вас включен обмен данными, то эти изменения будут видны всем вашим игрокам, которые также используют трекер боя. Однако обратите внимание, что изменения цвета <strong>не происходят мгновенно</strong>, и иногда вам приходится перемещать карту или иным образом взаимодействовать с ней, прежде чем изменения вступят в силу. Кроме того, OBR масштабирует область просмотра, чтобы она соответствовала краям карты, когда страница загружается. 
</p><p>
<span class="note">Таким образом эта настройка имеет преимущественно эстетический эффект, и он не помешает игрокам узнать настоящий размер вашей карты.</span>
</p>


<h2 id="dice">
Трекер кубиков
</h2>
<p>
Небольшое сворачиваемое окно журнала бросков в правом нижнем углу экрана, в котором отслеживается, что именно произошло и когда. Значения берутся с левой панели OBR. В отличие от родной панели, трекер показывает отдельные броски кубиков с отметкой времени, поэтому больше не нужно задаваться вопросом, какие кубики были брошены, если у игрока в лотке несколько кубов. 
</p>
<img src="../images/help_dice.jpg" alt="Окно с трекером бросков кубиков" title="Окно с трекером бросков кубиков">
<h3>
Содержимое трекера
</h3>
<p>
Броски костей записываются с именем и отметкой времени. Подробная информация, включая значения отдельных кубиков, всегда отображается для самого последнего броска. Чтобы просмотреть подробную информацию о предыдущих бросках, просто наведите на них указатель мыши.
</p><p>
Также в логе будут отображаться подключения/отключения игроков. Если у вас включен боевой трекер, в журнале также будут отображаться временные метки начала каждого нового раунда. В некотором смысле, это окно служит своего рода логом боя, в котором больше информации, чем просто броски костей.
</p>
<h3>
Подделка результатов бросков
</h3>
<p>
Текущая реализация бросков костей в OBR довольно проста. Вы должны явно разрешить делиться результатами бросков с другими игроками (Share dice), и до того, как вы это сделаете, другие не будут знать, какие кости вы бросаете, и даже бросали ли вы их вообще. Даже когда опция Share dice включена, результаты броска кубиков отправляются другим игрокам только в момент остановки кубиков. Всё это позволяет менять результаты в свою пользу.
</p><ul>
	<li>Игроки могут скрыть результаты броска, отключив передачу кубиков (Share dice), и перебрасывать несколько раз, пока не получат желаемый результат, а затем снова показать кубики. Другие увидят последний результат, как если бы кубики были только что брошены игроком.</li>
</ul><p>
Чтобы противостоять этому, аддон вообще не позволяет скрывать броски. Что касается игроков, которые могут отключить OBRT для обмана с кубами: трекер пытается отследить, когда броски кубиков скрыты. Он показывает сообщение <em style="white-space: nowrap;">"[Playername]</em><em> tempts fate"</em> ("Игрок искушает судьбу") прямо перед броском. Это сообщение означает, что пользователь только что снова включил передачу результата броска (Share dice). Если вы часто его видите, это означает, что человек снова и снова включает и выключает Share dice.
</p><p>
<span class="note">Если вы видите <em style="white-space: nowrap;">"[Playername]</em><em> tempts fate"</em>, значит, вероятно, этот человек читер.</span>
</p><ul>
	<li>Даже когда "Делиться результатами броска" включено, если игрок видит, что кубик вот-вот выпадет с нежелательным результатом, он может схватить его и снова бросить или нажать кнопку "перебросить" - и делать это до удовлетворительного результата.</li>
</ul><p>
Чтобы предотвратить это, кнопка переброса кубиков отключена, и лоток не отвечает на нажатия, пока кубики все еще катятся. Таким образом, любой, у кого есть работающий трекер кубиков, не сможет смошенничать, перебросив кубик до того, как он остановится. 
</p><p>
<span class="note">Конечно, ваши игроки могут отключить аддон и перебрасывать сколько угодно.</span>
</p>
<h3>
Изменения лотка кубиков
</h3>
<p>
Как упоминалось выше, чтобы противостоять подделке результатов броска, режим "Делиться результатами броска" (Share dice) всегда включен, перебросы отключены, а с лотком для кубиков нельзя взаимодействовать, пока кубики все еще движутся. Кроме того, не для каких-то античитерских мер, а просто для удобства лоток для кубиков скрывается при нажатии на него и опустошается при повторном открытии. 
</p>


<h2 id="sound">
Звуки кубиков
</h2>
<p>
Воспроизводит звук падающих костей всякий раз, когда вы бросаете кубики. Это чисто косметический эффект, и ничего кроме атмосферности и аутентичности он не добавляет.
</p>
<p>
Если трекер бросков кубиков включён, звук также воспроизводится всякий раз, когда кто-то другой бросает кости. Это бывает полезным, чтобы всегда оставаться в курсе событий. 
</p>